<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ATSync â€“ Shared Notepad</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1rem;
    }
    textarea {
      width: 100%;
      height: 80vh;
      font-size: 1rem;
      font-family: monospace;
    }
    button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
    }
  </style>
</head>
<body>
  <h1>ATSync â€“ Gist-Powered Notepad</h1>
  <textarea id="pad" placeholder="Loading..."></textarea><br />
  <button onclick="save()">ðŸ’¾ Save to Gist</button>

  <script>
    const gistId = "5b290d237691ff80b8cd194d57f4d401";
    const fileName = "content_1.txt";
    const token = "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"; // Scoped-token, not sensitive.

    async function load() {
      try {
        const res = await fetch(`https://api.github.com/gists/${gistId}`);
        const data = await res.json();
        document.getElementById("pad").value = data.files[fileName].content;
      } catch (err) {
        alert("Failed to load Gist: " + err.message);
      }
    }

    async function save() {
      const content = document.getElementById("pad").value;
      try {
        const res = await fetch(`https://api.github.com/gists/${gistId}`, {
          method: "PATCH",
          headers: {
            "Authorization": `token ${token}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            files: {
              [fileName]: { content }
            }
          })
        });
        if (res.ok) {
          alert("Saved!");
        } else {
          const errData = await res.json();
          alert("Failed to save: " + JSON.stringify(errData));
        }
      } catch (err) {
        alert("Error saving: " + err.message);
      }
    }

    load();
  </script>
</body>
</html>
